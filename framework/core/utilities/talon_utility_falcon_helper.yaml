name: talon_utility_falcon_helper
description: Utility macro providing Falcon console deep-link generation for hosts and processes.
visualization:
  options:
    columns:
    - fieldName: '@timestamp'
      format: datetime
      type: field
      width: 200
    - groupByPrefix: false
      header: Field List
      type: fieldList
    newestAtBottom: true
    showOnlyFirstLine: false
  type: list-view
labels:
- talon_hunt_framework
- asset
- utility
- enrichment
- global
$schema: https://schemas.humio.com/query/v0.6.0
timeInterval:
  isLive: false
  start: 15m
queryString: |-
  // =====================================================
  // UTILITY
  // =====================================================
  | case {
      AccountStatus = * | $falcon/helper:enrich(field=AccountStatus);
      ActiveDirectoryAuditActionType = * | $falcon/helper:enrich(field=ActiveDirectoryAuditActionType);
      ActiveDirectoryAuthenticationMethod = * | $falcon/helper:enrich(field=ActiveDirectoryAuthenticationMethod);
      ActiveDirectoryDataProtocol = * | $falcon/helper:enrich(field=ActiveDirectoryDataProtocol);
      ActiveDirectoryGroupScope = * | $falcon/helper:enrich(field=ActiveDirectoryGroupScope);
      AsepClass = * | $falcon/helper:enrich(field=AsepClass);
      AsepFlags = * | $falcon/helper:enrich(field=AsepFlags);
      AsepValueType = * | $falcon/helper:enrich(field=AsepValueType);
      AuthenticationFailureMsErrorCode = * | $falcon/helper:enrich(field=AuthenticationFailureMsErrorCode);
      AuthenticationId = * | $falcon/helper:enrich(field=AuthenticationId);
      AzureErrorCode = * | $falcon/helper:enrich(field=AzureErrorCode);
      CloudErrorCode = * | $falcon/helper:enrich(field=CloudErrorCode);
      CloudPlatform = * | $falcon/helper:enrich(field=CloudPlatform);
      ConnectionCipher = * | $falcon/helper:enrich(field=ConnectionCipher);
      ConnectionDirection = * | $falcon/helper:enrich(field=ConnectionDirection);
      ConnectionExchange = * | $falcon/helper:enrich(field=ConnectionExchange);
      ConnectionFlags = * | $falcon/helper:enrich(field=ConnectionFlags);
      ConnectionHash = * | $falcon/helper:enrich(field=ConnectionHash);
      ConnectionProtocol = * | $falcon/helper:enrich(field=ConnectionProtocol);
      ConnectType = * | $falcon/helper:enrich(field=ConnectType);
      CpuVendor = * | $falcon/helper:enrich(field=CpuVendor);
      CreateProcessType = * | $falcon/helper:enrich(field=CreateProcessType);
      DnsResponseType = * | $falcon/helper:enrich(field=DnsResponseType);
      DriverLoadFlags = * | $falcon/helper:enrich(field=DriverLoadFlags);
      DualRequest = * | $falcon/helper:enrich(field=DualRequest);
      EfiSupported = * | $falcon/helper:enrich(field=EfiSupported);
      EtwProviders = * | $falcon/helper:enrich(field=EtwProviders);
      ExclusionSource = * | $falcon/helper:enrich(field=ExclusionSource);
      ExclusionType = * | $falcon/helper:enrich(field=ExclusionType);
      ExitCode = * | $falcon/helper:enrich(field=ExitCode);
      FileAttributes = * | $falcon/helper:enrich(field=FileAttributes);
      FileCategory = * | $falcon/helper:enrich(field=FileCategory);
      FileMode = * | $falcon/helper:enrich(field=FileMode);
      FileSubType = * | $falcon/helper:enrich(field=FileSubType);
      FileWrittenFlags = * | $falcon/helper:enrich(field=FileWrittenFlags);
      HashAlgorithm = * | $falcon/helper:enrich(field=HashAlgorithm);
      HookId = * | $falcon/helper:enrich(field=HookId);
      HTTPMethod = * | $falcon/helper:enrich(field=HTTPMethod);
      HTTPStatus = * | $falcon/helper:enrich(field=HTTPStatus);
      IcmpType = * | $falcon/helper:enrich(field=IcmpType);
      ImageSubsystem = * | $falcon/helper:enrich(field=ImageSubsystem);
      IntegrityLevel = * | $falcon/helper:enrich(field=IntegrityLevel);
      IP.country = * | $falcon/helper:enrich(field=IP.country);
      IsAndroidAppContainerized = * | $falcon/helper:enrich(field=IsAndroidAppContainerized);
      IsDebugPath = * | $falcon/helper:enrich(field=IsDebugPath);
      IsEcho = * | $falcon/helper:enrich(field=IsEcho);
      IsNorthBridgeSupported = * | $falcon/helper:enrich(field=IsNorthBridgeSupported);
      IsOnNetwork = * | $falcon/helper:enrich(field=IsOnNetwork);
      IsOnRemovableDisk = * | $falcon/helper:enrich(field=IsOnRemovableDisk);
      IsSouthBridgeSupported = * | $falcon/helper:enrich(field=IsSouthBridgeSupported);
      IsTransactedFile = * | $falcon/helper:enrich(field=IsTransactedFile);
      KDCOptions = * | $falcon/helper:enrich(field=KDCOptions);
      KerberosAnomaly = * | $falcon/helper:enrich(field=KerberosAnomaly);
      KerberosErrorCode = * | $falcon/helper:enrich(field=KerberosErrorCode);
      LanguageId = * | $falcon/helper:enrich(field=LanguageId);
      LdapErrorResultCode = * | $falcon/helper:enrich(field=LdapErrorResultCode);
      LdapSearchQueryClassification = * | $falcon/helper:enrich(field=LdapSearchQueryClassification);
      LdapSearchScope = * | $falcon/helper:enrich(field=LdapSearchScope);
      LdapSecurityType = * | $falcon/helper:enrich(field=LdapSecurityType);
      LinuxSensorBackend = * | $falcon/helper:enrich(field=LinuxSensorBackend);
      LogonType = * | $falcon/helper:enrich(field=LogonType);
      MachOSubType = * | $falcon/helper:enrich(field=MachOSubType);
      MappedFromUserMode = * | $falcon/helper:enrich(field=MappedFromUserMode);
      NamedPipeImpersonationType = * | $falcon/helper:enrich(field=NamedPipeImpersonationType);
      NamedPipeOperationType = * | $falcon/helper:enrich(field=NamedPipeOperationType);
      NetworkContainmentState = * | $falcon/helper:enrich(field=NetworkContainmentState);
      NetworkProfile = * | $falcon/helper:enrich(field=NetworkProfile);
      NewFileAttributesLinux = * | $falcon/helper:enrich(field=NewFileAttributesLinux);
      NtlmAvFlags = * | $falcon/helper:enrich(field=NtlmAvFlags);
      ObjectAccessOperationType = * | $falcon/helper:enrich(field=ObjectAccessOperationType);
      ObjectType = * | $falcon/helper:enrich(field=ObjectType);
      OciContainerHostConfigReadOnlyRootfs = * | $falcon/helper:enrich(field=OciContainerHostConfigReadOnlyRootfs);
      OciContainerPhase = * | $falcon/helper:enrich(field=OciContainerPhase);
      OktaErrorCode = * | $falcon/helper:enrich(field=OktaErrorCode);
      PolicyRuleSeverity = * | $falcon/helper:enrich(field=PolicyRuleSeverity);
      PreviousFileAttributesLinux = * | $falcon/helper:enrich(field=PreviousFileAttributesLinux);
      PrimaryModule = * | $falcon/helper:enrich(field=PrimaryModule);
      ProductType = * | $falcon/helper:enrich(field=ProductType);
      Protocol = * | $falcon/helper:enrich(field=Protocol);
      ProvisionState = * | $falcon/helper:enrich(field=ProvisionState);
      RebootRequired = * | $falcon/helper:enrich(field=RebootRequired);
      RegOperationType = * | $falcon/helper:enrich(field=RegOperationType);
      RegType = * | $falcon/helper:enrich(field=RegType);
      RemoteAccount = * | $falcon/helper:enrich(field=RemoteAccount);
      RequestType = * | $falcon/helper:enrich(field=RequestType);
      RpcOpClassification = * | $falcon/helper:enrich(field=RpcOpClassification);
      RuleAction = * | $falcon/helper:enrich(field=RuleAction);
      SecurityInformationLinux = * | $falcon/helper:enrich(field=SecurityInformationLinux);
      SensorStateBitMap = * | $falcon/helper:enrich(field=SensorStateBitMap);
      ServiceCurrentState = * | $falcon/helper:enrich(field=ServiceCurrentState);
      ServiceType = * | $falcon/helper:enrich(field=ServiceType);
      ShowWindowFlags = * | $falcon/helper:enrich(field=ShowWindowFlags);
      SignInfoFlagFailedCertCheck = * | $falcon/helper:enrich(field=SignInfoFlagFailedCertCheck);
      SignInfoFlagNoEmbeddedCert = * | $falcon/helper:enrich(field=SignInfoFlagNoEmbeddedCert);
      SignInfoFlagNoSignature = * | $falcon/helper:enrich(field=SignInfoFlagNoSignature);
      SourceAccountType = * | $falcon/helper:enrich(field=SourceAccountType);
      SourceEndpointHostNameResolutionMethod = * | $falcon/helper:enrich(field=SourceEndpointHostNameResolutionMethod);
      SourceEndpointIpReputation = * | $falcon/helper:enrich(field=SourceEndpointIpReputation);
      SourceEndpointNetworkType = * | $falcon/helper:enrich(field=SourceEndpointNetworkType);
      SsoEventSource = * | $falcon/helper:enrich(field=SsoEventSource);
      Status = * | $falcon/helper:enrich(field=Status);
      SubStatus = * | $falcon/helper:enrich(field=SubStatus);
      TargetAccountType = * | $falcon/helper:enrich(field=TargetAccountType);
      TargetServiceAccessClassification = * | $falcon/helper:enrich(field=TargetServiceAccessClassification);
      TcpConnectErrorCode = * | $falcon/helper:enrich(field=TcpConnectErrorCode);
      ThreadExecutionControlType = * | $falcon/helper:enrich(field=ThreadExecutionControlType);
      TlsVersion = * | $falcon/helper:enrich(field=TlsVersion);
      TokenType = * | $falcon/helper:enrich(field=TokenType);
      UserIsAdmin = * | $falcon/helper:enrich(field=UserIsAdmin);
      WellKnownTargetFunction = * | $falcon/helper:enrich(field=WellKnownTargetFunction);
      ZoneIdentifier = * | $falcon/helper:enrich(field=ZoneIdentifier);
      *
  }
