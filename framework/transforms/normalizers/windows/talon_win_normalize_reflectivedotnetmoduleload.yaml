name: talon_win_normalize_reflectivedotnetmoduleload
description: Normalizes event fields using conditional logic to standardize values across different event sources.
visualization:
  options:
    columns:
    - fieldName: '@timestamp'
      format: datetime
      type: field
      width: 200
    - groupByPrefix: false
      header: Field List
      type: fieldList
    newestAtBottom: true
    showOnlyFirstLine: false
  type: list-view
labels:
- talon_hunt_framework
- asset
- normalize
- reflectivedotnetmoduleload
- windows
$schema: https://schemas.humio.com/query/v0.6.0
timeInterval:
  isLive: false
  start: 15m
queryString: |-
  // =====================================================
  // NORMALIZATION
  // =====================================================
  | case {
      AssemblyFlags = "1" | AssemblyFlags := "ASSEMBLY_DOMAIN_NEUTRAL";
      AssemblyFlags = "2" | AssemblyFlags := "ASSEMBLY_DYNAMIC";
      AssemblyFlags = "4" | AssemblyFlags := "ASSEMBLY_HAS_NATIVE_IMAGE";
      AssemblyFlags = "8" | AssemblyFlags := "ASSEMBLY_COLLECTIBLE";
      *
  }

  | case {
      DotnetModuleFlags = "1" | DotnetModuleFlags := "DOTNET_MODULE_DOMAIN_NEUTRAL";
      DotnetModuleFlags = "2" | DotnetModuleFlags := "DOTNET_MODULE_HAS_NATIVE_IMAGE";
      DotnetModuleFlags = "4" | DotnetModuleFlags := "DOTNET_MODULE_DYNAMIC";
      DotnetModuleFlags = "8" | DotnetModuleFlags := "DOTNET_MODULE_MANIFEST";
      *
  }

  | case {
      EtwProviderType = "0" | EtwProviderType := "NONE";
      EtwProviderType = "1" | EtwProviderType := "MOF";
      EtwProviderType = "2" | EtwProviderType := "MANIFEST";
      EtwProviderType = "3" | EtwProviderType := "WPP";
      *
  }
