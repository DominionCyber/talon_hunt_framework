name: talon_win_normalize_file_path
description: Normalizes and standardizes event fields for consistent downstream processing.
visualization:
  options:
    columns:
    - fieldName: '@timestamp'
      format: datetime
      type: field
      width: 200
    - groupByPrefix: false
      header: Field List
      type: fieldList
    newestAtBottom: true
    showOnlyFirstLine: false
  type: list-view
labels:
- talon_hunt_framework
- asset
- normalize
- filepath
- windows
$schema: https://schemas.humio.com/query/v0.6.0
timeInterval:
  isLive: false
  start: 15m
queryString: |-
  // =====================================================
  // NORMALIZATION
  // =====================================================
  | replace(
      "^(\\\\Device\\\\HarddiskVolume\\d+)",
      with="HDD",
      field=?TargetField
  )
  
  | replace(
      "^(\\\\Device\\\\Mup)",
      with="UNC",
      field=?TargetField
  )
  
