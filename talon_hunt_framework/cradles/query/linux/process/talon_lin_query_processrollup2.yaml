name: talon_lin_query_processrollup2
description: Base query for ProcessRollup2 events. Applies normalization and field standardization for process execution data.
visualization:
  options:
    cell-overflow: wrap-text
    column-overflow: truncate
    configured-columns: {}
    row-numbers-enabled: false
  type: table-view
labels:
- talon_hunt_framework
- query
- processrollup2
- linux
- falcon_container
$schema: https://schemas.humio.com/query/v0.6.0
timeInterval:
  isLive: false
  start: 15m
queryString: |-
  // =====================================================
  // SEARCH
  // =====================================================
  #event_simpleName=ProcessRollup2 event_platform=Lin

  // =====================================================
  // SEARCH ASSETS
  // =====================================================
  | $talon_convert_time_utc()
  | $talon_utility_falcon_helper()
  | $talon_lin_normalize_processrollup2()

  // =====================================================
  // TABLE
  // =====================================================
  | table(
      [
          utc_time,
          UID,
          RUID,
          GID,
          RGID,
          SourceProcessId,
          ParentProcessId,
          ParentBaseFileName,
          ImageFileName,
          CommandLine,
          SHA256HashData,
          SHA1HashData,
          MD5HashData,
          SSHSessionId,
          TtyName,
          OciContainerId,
          PodId,
          PIDNamespaceId,
          RootPath,
          ProcessStartTime,
          ProcessEndTime,
          ProcessGroupId,
          TargetProcessId,
          RawProcessId,
          TreeId,
          NDRoot,
          SVUID,
          SVGID,
          CapPrm,
          CapPrm_mask
      ],
      limit=max
  )
